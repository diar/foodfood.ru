var restaurant_photo_count=0,restaurant_photo_visible=6,restaurant_photo_offset=0,restaurant_photo_position=0,person_item_count=0,person_item_position=0,person_item_visible=0;
$(document).ready(function(){check_window_width();$.browser.msie||$(window).resize(function(){check_window_width()});if(typeof rest_page_activate!="undefined"){$(".link.discount_icon a").click(function(){$("#discount_submit").attr("partner",$(this).attr("partner"));title=$(".caption .title").html();percent=$(this).attr("percent");description=$(this).parent().find(".discount_description").html();$("#discount_dialog .name").html(title);$("#discount_dialog .description_discount").html(description);$("#discount_dialog .discount_percent .number").html(""+
percent+" <span>%</span>");$.showDialog("discount_dialog");return false});$("#restaurant_info .photos .mini").each(function(){restaurant_photo_count++;restaurant_photo_count<=restaurant_photo_visible&&$(this).show();$(this).attr("pos",restaurant_photo_count)});$("#restaurant_info .photos .mini").click(function(){min=this;$("#restaurant_info .photos .mini.active").removeClass("active");$(min).addClass("active");$("#restaurant_info .photos .main").animate({opacity:"hide"},300,function(){$("#restaurant_info .photos .main").attr("src",
$(min).attr("src"));$("#restaurant_info .photos .main").animate({opacity:"show"},300)});restaurant_photo_position=parseInt($(min).attr("pos"))-restaurant_photo_offset;if(restaurant_photo_position==restaurant_photo_visible&&restaurant_photo_position+restaurant_photo_offset<restaurant_photo_count){restaurant_photo_offset++;show_pos=restaurant_photo_offset+restaurant_photo_visible;$("#restaurant_info .photos .mini[pos="+restaurant_photo_offset+"]").animate({width:"hide"},200);$("#restaurant_info .photos .mini[pos="+
show_pos+"]").animate({width:"show"},200)}else if(restaurant_photo_position==1&&restaurant_photo_offset>0){restaurant_photo_offset--;show_pos=restaurant_photo_offset+1;hide_pos=restaurant_photo_offset+restaurant_photo_visible+1;$("#restaurant_info .photos .mini[pos="+hide_pos+"]").animate({width:"hide"},200);$("#restaurant_info .photos .mini[pos="+show_pos+"]").animate({width:"show"},200)}});$(".restaurant_header .rest_rating .minus").click(function(){update_rating_without_text(current_rest_id,"lcomment")});
$(".restaurant_header .rest_rating .plus").click(function(){update_rating_without_text(current_rest_id,"rcomment")});$('.reviews .form input[type="submit"]').click(function(){text=$(this).parents("form").find("textarea").val();comment_rest(current_rest_id,text);return false});$(".map_link a").click(function(){$.showDialog("google_dialog");return false})}if(typeof cal\u0441_activate!="undefined"){$(".add_trash_item").click(function(){$parent=$(this).parents(".dish_item");dish=$parent.attr("id");if($("#trash_"+
dish).length){cn=parseInt($("#trash_"+dish).find(".number").html());$("#trash_"+dish).find(".number").html(cn+1);price=$("#trash_"+dish).find(".price").html();price=parseInt(price/cn*(cn+1));$("#trash_"+dish).find(".price").html(price)}else{title=$parent.find(".title").html();price=$parent.find(".price span").html();$trash_item=$('<tr class="trash_item" id="trash_'+dish+'"><td class="title">'+title+'</td><td class="count"><div class="number">1</div><div class="actions"><div class="add"><img class="trash_add_item" src="/public/images/icons/small_add_icon.png"/></div><div class="remove"><img class="trash_remove_item" src="/public/images/icons/small_remove_icon.png"/></div></div></td><td class="price">'+
price+"</td></tr>");$(".trash .items table").append($trash_item);$trash_item.find(".trash_add_item").click(function(){cn=parseInt($(this).parents(".trash_item").find(".number").html());$(this).parents(".trash_item").find(".number").html(cn+1);price=$(this).parents(".trash_item").find(".price").html();price=parseInt(price/cn*(cn+1));$(this).parents(".trash_item").find(".price").html(price)});$trash_item.find(".trash_remove_item").click(function(){cn=parseInt($(this).parents(".trash_item").find(".number").html());
if(cn>1){$(this).parents(".trash_item").find(".number").html(cn-1);price=$(this).parents(".trash_item").find(".price").html();price=parseInt(price/cn*(cn-1));$(this).parents(".trash_item").find(".price").html(price)}else $trash_item.remove()})}});$(".remove_trash_item").click(function(){$parent=$(this).parents(".dish_item_l");dish=$parent.attr("rel");if($("#trash_"+dish).length){cn=parseInt($("#trash_"+dish).find(".number").html());if(cn>1){$("#trash_"+dish).find(".number").html(cn-1);price=$("#trash_"+
dish).find(".price").html();price=parseInt(price/cn*(cn-1));$("#trash_"+dish).find(".price").html(price)}else $("#trash_"+dish).remove()}})}if(typeof person_page_activate!="undefined"){$(".restaurant_header .next").click(function(){if(person_item_position+person_item_visible<person_item_count){person_item_position++;$("#persons_list").animate({scrollLeft:Math.ceil(person_item_position*182)},300)}});$(".restaurant_header .back").click(function(){if(person_item_position>0){person_item_position--;$("#persons_list").animate({scrollLeft:Math.ceil(person_item_position*
182)},300)}});$("#persons_list .item").click(function(){id=$(this).attr("rel");$("#person").html("");$("#person").append($loader);$("#person #loader").show();$.post("/"+site_city+"/persons/view/"+id,function(a){$("#person").html(a);name=$("#person .name").html();$("#person_name_caption").html(name);$(".interview .quest").click(function(){$(".interview .quest.active").removeClass("active");$(this).addClass("active");$(".interview .answer").hide();$(this).parent(".int").find(".answer").show()})})});
$.post("/"+site_city+"/persons/view/",function(a){$("#person").html(a);name=$("#person .name").html();$("#person_name_caption").html(name);$(".interview .quest").click(function(){$(".interview .quest.active").removeClass("active");$(this).addClass("active");$(".interview .answer").hide();$(this).parent(".int").find(".answer").show()})})}$(".select_percent div").click(function(){per=$(this).attr("class");if(per!="all"){$(".discount_list .item").hide();$(".discount_list .item:has(."+per+")").show()}else $(".discount_list .item").show()})});
function check_window_width(){mood_check_width();by_mood_check_width();typeof person_page_activate!="undefined"&&persons_check_width()}
function by_mood_check_width(){$("#restaurant_by_mood_content .item").css("display","none");by_mood_visible=by_mood_add_count=(Math.ceil(($(document).width()-10)/230)-1)*2;by_mood_position=by_mood_count=0;counter=1;$("#restaurant_by_mood_content .item").each(function(){$(this).attr("id","by_mood_item_"+counter);counter+=1;if(by_mood_add_count>0){$(this).animate({width:"show"},100);by_mood_add_count--}by_mood_count++})}
function persons_check_width(){person_item_visible=Math.ceil(($(document).width()-10)/182)-1;$("#persons_list").width(person_item_visible*182);person_item_count=$("#persons_list .item").length}
function comment_rest(a,c){user_auth!="1"?$.alert("\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u043e\u0439\u0442\u0438 \u043d\u0430 \u0441\u0430\u0439\u0442, \u0447\u0442\u043e\u0431\u044b \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043e\u0442\u0437\u044b\u0432\u044b",true):$.post("/"+site_city+"/restaurant/comment/"+a+"/",{text:c},function(b){if(b=="OK")$.alert("\u041e\u0442\u0437\u044b\u0432 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d",false);else if(b=="NO_LOGIN")$.alert("\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0432\u043e\u0439\u0442\u0438 \u043d\u0430 \u0441\u0430\u0439\u0442, \u0447\u0442\u043e\u0431\u044b \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u043e\u0442\u0437\u044b\u0432\u044b",
true);else if(b=="ALREADY")$.alert("\u0412\u044b \u0443\u0436\u0435 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u043b\u0438 \u043e\u0442\u0437\u044b\u0432 \u0434\u043b\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0440\u0435\u0441\u0442\u043e\u0440\u0430\u043d\u0430",true);else b=="LENGTH"?$.alert("\u0414\u043b\u0438\u043d\u0430 \u043e\u0442\u0437\u044b\u0432\u0430 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u0430 \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0442\u044c 500 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432",
true):$.alert("\u041e\u0448\u0438\u0431\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0435 \u0440\u0430\u0437",true)})};